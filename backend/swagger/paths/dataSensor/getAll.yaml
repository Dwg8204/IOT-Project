/api/data-sensor:
  get:
    tags:
      - Data Sensor
    summary: Quản lý dữ liệu cảm biến (All-in-One)
    description: |
      **Endpoint đa chức năng hỗ trợ:**
      
      ### Lấy tất cả dữ liệu
      ```
      GET /api/data-sensor?page=1&limit=10
      ```
      
      ### Tìm kiếm theo nhiệt độ
      ```
      GET /api/data-sensor?keyword=28.5&searchType=temperature
      ```
      
      ### Tìm kiếm theo độ ẩm
      ```
      GET /api/data-sensor?keyword=65&searchType=humidity
      ```
      
      ### Tìm kiếm theo ánh sáng
      ```
      GET /api/data-sensor?keyword=320&searchType=light
      ```
      
      ### Tìm kiếm theo thời gian
      ```
      GET /api/data-sensor?keyword=7/10/2025&searchType=time
      ```
      
      ### Sắp xếp
      ```
      GET /api/data-sensor?sortKey=temperature&sortValue=-1
      ```
      
      ### Kết hợp tất cả
      ```
      GET /api/data-sensor?keyword=28.5&searchType=temperature&sortKey=createdAt&sortValue=-1&page=1&limit=10
      ```
      
      ---
      
      ## ĐỊNH DẠNG THỜI GIAN
      
      Khi `searchType=time`, hỗ trợ các format:
      - `DD/MM/YYYY` - VD: `7/10/2025`
      - `HH:MM:SS DD/MM/YYYY` - VD: `10:30:45 7/10/2025`
      - `HH:MM DD/MM/YYYY` - VD: `10:30 7/10/2025`
      - `YYYY-MM-DD` - VD: `2025-10-07`
      - `YYYY-MM-DDTHH:MM:SS.sssZ` - VD: `2025-10-07T10:30:45.123Z`
    
    parameters:
      # ==================== SEARCH PARAMETERS ====================
      - name: keyword
        in: query
        description: |
          Từ khóa tìm kiếm (tùy chọn)
          - Nếu searchType=temperature/humidity/light → Nhập số
          - Nếu searchType=time → Nhập định dạng thời gian
          - Nếu KHÔNG truyền → Lấy tất cả
        required: false
        schema:
          type: string
        examples:
          temperature:
            summary: Tìm nhiệt độ
            value: "28.5"
          humidity:
            summary: Tìm độ ẩm
            value: "65"
          light:
            summary: Tìm ánh sáng
            value: "320"
          timeFullDay:
            summary: Tìm cả ngày
            value: "7/10/2025"
          timeExact:
            summary: Tìm chính xác đến giây
            value: "10:30:45 7/10/2025"
      
      - name: searchType
        in: query
        description: |
          Loại tìm kiếm (tùy chọn)
          - Chỉ có tác dụng khi có `keyword`
        required: false
        schema:
          type: string
          enum: [time, temperature, humidity, light]
          default: time
        examples:
          time:
            summary: Tìm theo thời gian
            value: time
          temperature:
            summary: Tìm theo nhiệt độ
            value: temperature
          humidity:
            summary: Tìm theo độ ẩm
            value: humidity
          light:
            summary: Tìm theo ánh sáng
            value: light
      
      # ==================== SORT PARAMETERS ====================
      - name: sortKey
        in: query
        description: Trường cần sắp xếp (tùy chọn)
        required: false
        schema:
          type: string
          enum: [createdAt, temperature, humidity, light]
          default: createdAt
        examples:
          byTime:
            summary: Sắp xếp theo thời gian
            value: createdAt
          byTemp:
            summary: Sắp xếp theo nhiệt độ
            value: temperature
          byHumidity:
            summary: Sắp xếp theo độ ẩm
            value: humidity
          byLight:
            summary: Sắp xếp theo ánh sáng
            value: light
      
      - name: sortValue
        in: query
        description: |
          Thứ tự sắp xếp (tùy chọn):
          - `1` = Tăng dần (ASC) ↑
          - `-1` = Giảm dần (DESC) ↓
        required: false
        schema:
          type: integer
          enum: [1, -1]
          default: -1
        examples:
          ascending:
            summary: Tăng dần
            value: 1
          descending:
            summary: Giảm dần
            value: -1
      
      # ==================== PAGINATION PARAMETERS ====================
      - name: page
        in: query
        description: Số trang (bắt đầu từ 1)
        required: false
        schema:
          type: integer
          minimum: 1
          default: 1
          example: 1
      
      - name: limit
        in: query
        description: Số bản ghi mỗi trang (max 1000)
        required: false
        schema:
          type: integer
          minimum: 1
          maximum: 1000
          default: 5
          example: 10

    responses:
      '200':
        description: Thành công
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataSensorList'
            examples:
              getAllData:
                summary:  Lấy tất cả (không filter)
                value:
                  data:
                    - _id: "671a2b3c4d5e6f7890123456"
                      temperature: 28.5
                      humidity: 68.0
                      light: 320
                      createdAt: "2025-10-07T10:15:30.456Z"
                    - _id: "671a2b3c4d5e6f7890123457"
                      temperature: 29.7
                      humidity: 65.5
                      light: 450
                      createdAt: "2025-10-07T10:15:35.456Z"
                  pagination:
                    totalItems: 1542
                    currentPage: 1
                    totalPages: 309
                    limitItem: 5
              
              searchTemperature:
                summary: Tìm nhiệt độ 28.5
                value:
                  data:
                    - _id: "671a2b3c4d5e6f7890123456"
                      temperature: 28.5
                      humidity: 68.0
                      light: 320
                      createdAt: "2025-10-07T10:15:30.456Z"
                    - _id: "671a2b3c4d5e6f7890123459"
                      temperature: 28.5
                      humidity: 70.0
                      light: 340
                      createdAt: "2025-10-07T09:45:20.123Z"
                  pagination:
                    totalItems: 15
                    currentPage: 1
                    totalPages: 3
                    limitItem: 5
              
              searchHumidity:
                summary: Tìm độ ẩm 65
                value:
                  data:
                    - temperature: 29.7
                      humidity: 65.0
                      light: 450
                      createdAt: "2025-10-07T11:20:00Z"
                  pagination:
                    totalItems: 22
                    currentPage: 1
                    totalPages: 5
                    limitItem: 5
              
              searchLight:
                summary: Tìm ánh sáng 320
                value:
                  data:
                    - temperature: 28.5
                      humidity: 68.0
                      light: 320
                      createdAt: "2025-10-07T10:15:30Z"
                  pagination:
                    totalItems: 8
                    currentPage: 1
                    totalPages: 2
                    limitItem: 5
              
              searchTime:
                summary: Tìm ngày 7/10/2025
                value:
                  data:
                    - temperature: 28.5
                      humidity: 68.0
                      light: 320
                      createdAt: "2025-10-07T10:15:30.456Z"
                    - temperature: 29.0
                      humidity: 65.0
                      light: 350
                      createdAt: "2025-10-07T11:20:15.789Z"
                  pagination:
                    totalItems: 48
                    currentPage: 1
                    totalPages: 10
                    limitItem: 5
              
              sortByTempAsc:
                summary: Sắp xếp nhiệt độ tăng dần
                value:
                  data:
                    - temperature: 18.5
                      humidity: 75.0
                      light: 180
                      createdAt: "2025-10-07T08:00:00Z"
                    - temperature: 22.0
                      humidity: 70.0
                      light: 250
                      createdAt: "2025-10-07T09:00:00Z"
                  pagination:
                    totalItems: 1542
                    currentPage: 1
                    totalPages: 309
                    limitItem: 5
              
              sortByTempDesc:
                summary:  Sắp xếp nhiệt độ giảm dần
                value:
                  data:
                    - temperature: 35.5
                      humidity: 60.0
                      light: 450
                      createdAt: "2025-10-07T14:00:00Z"
                    - temperature: 32.0
                      humidity: 62.5
                      light: 380
                      createdAt: "2025-10-07T13:30:00Z"
                  pagination:
                    totalItems: 1542
                    currentPage: 1
                    totalPages: 309
                    limitItem: 5
              
              combinedSearch:
                summary: Tìm temp=28.5, sort theo thời gian DESC
                value:
                  data:
                    - temperature: 28.5
                      humidity: 68.0
                      light: 320
                      createdAt: "2025-10-07T10:15:30.456Z"
                    - temperature: 28.5
                      humidity: 70.0
                      light: 340
                      createdAt: "2025-10-07T09:45:20.123Z"
                  pagination:
                    totalItems: 15
                    currentPage: 1
                    totalPages: 3
                    limitItem: 5
      
      '400':
        description: Tìm kiếm không hợp lệ
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'
            examples:
              invalidNumber:
                summary: Nhập text cho searchType số
                value:
                  error: "Invalid search"
                  message: "Giá trị tìm kiếm \"abc\" không hợp lệ cho loại \"temperature\""
                  hint: "Vui lòng nhập một số hợp lệ"
              
              invalidTime:
                summary: Nhập số cho searchType time
                value:
                  error: "Invalid search"
                  message: "Giá trị tìm kiếm \"320\" không hợp lệ cho loại \"time\""
                  hint: "Vui lòng nhập thời gian đúng định dạng (VD: 7/10/2025, 09:12:42 3/10/2025, hoặc 2025-10-03)"
      
      '500':
        description: Lỗi server
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Error'